<div class="min-h-screen max-w-screen-zxl mx-auto">
  <p-toast></p-toast>

  <!-- Header Section -->
  <div class="header-section">
    <div class="max-w-7xl mx-auto px-4 py-8">
      <div class="text-center">
        <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">
          {{ 'packages.our_packages' | translate }}
        </h1>
      </div>
    </div>
  </div>


  <!-- Loading State -->
  <div *ngIf="loading()" class="max-w-7xl mx-auto px-4 py-8">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      <div *ngFor="let item of [1,2,3,4,5,6,7,8]" class="package-skeleton">
        <p-skeleton height="200px" class="mb-3"></p-skeleton>
        <p-skeleton height="20px" class="mb-2"></p-skeleton>
        <p-skeleton height="16px" class="mb-2"></p-skeleton>
        <p-skeleton height="16px" class="mb-3"></p-skeleton>
        <div class="flex gap-2">
          <p-skeleton height="32px" width="60px"></p-skeleton>
          <p-skeleton height="32px" width="60px"></p-skeleton>
        </div>
      </div>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error() && !loading()" class="max-w-7xl mx-auto px-4 py-8">
    <div class="text-center">
      <i class="pi pi-exclamation-triangle text-6xl text-red-500 mb-4"></i>
      <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">
        {{ 'packages.something_went_wrong' | translate }}
      </h3>
      <p class="text-gray-600 dark:text-gray-300 mb-4">{{ error() }}</p>
      <button 
        pButton 
        [label]="'packages.try_again' | translate" 
        icon="pi pi-refresh" 
        class="p-button-primary"
        (click)="loadPackages()"
      ></button>
    </div>
  </div>

  <!-- Packages Grid -->
  <div *ngIf="!loading() && !error()" class="max-w-7xl mx-auto px-4 py-8">
    <!-- No Packages Found -->
    <div *ngIf="packages().length === 0" class="text-center py-12">
      <i class="pi pi-box !text-7xl text-gray-400 mb-4"></i>
      <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">
        {{ 'packages.no_packages_found' | translate }}
      </h3>
      <!-- <p class="text-gray-600 dark:text-gray-300">
        {{ 'packages.try_adjusting_search' | translate }}
      </p> -->
    </div>

    <!-- Packages Grid -->
    <div *ngIf="packages().length > 0" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      <div *ngFor="let package of packages()" class="package-card">
        <p-card styleClass="h-full package-card-inner">
          <!-- Package Image -->
          <div class="package-image-container mb-4">
            <img 
              [src]="getMainImage(package)" 
              [alt]="package.name"
              class="w-full h-48 object-cover rounded-lg"
                             (error)="onImageError($event)"
            />
            
            <!-- Discount Badge -->
            <div *ngIf="package.discountPrice" class="discount-badge">
              -{{ getDiscountPercentage(package) }}%
            </div>

            <!-- Stock Badge -->
            <div class="stock-badge" [class.low-stock]="package.stock <= 5">
              {{ package.stock > 0 ? (package.stock <= 5 ? 'Low Stock' : 'In Stock') : 'Out of Stock' }}
            </div>
          </div>

          <!-- Package Info -->
          <div class="package-info p-2">
            <!-- Package Name -->
            <h3 class="package-name mb-2">
              {{ package.name | multiLanguage }}
            </h3>

            <!-- Rating -->
            <div class="rating-container mb-2" *ngIf="package.averageRating > 0">
              <p-rating 
                [ngModel]="package.averageRating" 
                [readonly]="true" 
                [stars]="5"
 
              ></p-rating>
              <span class="rating-text">
                ({{ package.reviewCount }} reviews)
              </span>
            </div>

            <!-- Description -->
            <p class="package-description mb-3 line-clamp-3 ">
              {{ package.description | multiLanguage}}
            </p>

            <!-- Items Count -->
            <div class="items-count mb-3">
              <i class="pi pi-box text-blue-500 mr-2"></i>
              <span class="text-sm text-gray-600 dark:text-gray-400">
                {{ 'packages.items_included' | translate: {count: getItemsCount(package)} }}
              </span>
            </div>

            <!-- Tags -->
            <div class="tags-container mb-4" *ngIf="getTags(package).length > 0">
              <p-chip 
                *ngFor="let tag of getTags(package)" 
                [label]="tag"
                class="mr-2 mb-2"
              ></p-chip>
            </div>

            <!-- Price Section -->
            <div class="price-section mb-4">
              <div class="price-container">
                <span *ngIf="package.discountPrice" class="original-price">
                  ${{ package.price.toFixed(2) }}
                </span>
                <span class="current-price">
                  ${{ (package.price - (package.discountPrice || 0)).toFixed(2) }}
                </span>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
              <button 
                pButton 
                [label]="'packages.view_details' | translate" 
                icon="pi pi-eye" 
                class=" p-button-outlined flex-1 mr-2"
                (click)="viewPackage(package)"
              ></button>
              
              <!-- <button 
                pButton 
                icon="pi pi-heart" 
                class="p-button-outlined p-button-secondary"
                pTooltip="Add to Wishlist"
                (click)="addToWishlist(package)"
              ></button> -->
            </div>

            <!-- Quick Add to Cart -->
            <!-- <button 
              pButton 
              label="Add to Cart" 
              icon="pi pi-shopping-cart" 
              class="p-button-success w-full mt-3"
              [disabled]="package.stock === 0"
              (click)="addToCart(package)"
            ></button> -->
          </div>
        </p-card>
      </div>
    </div>

    <!-- Load More Button -->
    <div *ngIf="packages().length > 10" class="text-center mt-8">
      <button 
        pButton 
        [label]="'packages.load_more_packages' | translate" 
        icon="pi pi-plus" 
        class="p-button-outlined"
      ></button>
    </div>
  </div>
</div>
