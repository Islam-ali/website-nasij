@if (reviews.length > 0) {
<section class="py-20 bg-gradient-to-b from-white to-gray-50 dark:from-gray-900 dark:to-gray-800 transition-colors duration-300">
  <div class="max-w-[1922px] mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center mb-16">
      <span
        class="inline-flex items-center px-4 py-2 rounded-full text-sm font-medium bg-primary-400 dark:bg-primary-400/30 text-gray-100 dark:text-primary-500 mb-4 transition-colors duration-300">
        <i class="pi pi-star-fill me-2"></i>
        {{ 'reviews.customer_reviews' | translate }}
      </span>
      <h2
        class="text-4xl lg:text-5xl font-bold text-gray-900 dark:text-white mt-2 mb-4 transition-colors duration-300">
        <span
          class="bg-gradient-to-r from-primary-400 to-primary-800 dark:from-primary-400 dark:to-primary-800 bg-clip-text text-transparent">
          {{ 'reviews.what_customers_say' | translate }}
        </span>
      </h2>
      <p class="text-gray-600 dark:text-gray-300 max-w-2xl mx-auto text-lg transition-colors duration-300">
        {{ 'reviews.real_feedback' | translate }}
      </p>
    </div>

    <!-- Reviews Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
      @for (review of reviews; track review._id) {
      <div
        class="group relative bg-white dark:bg-gray-800 rounded-2xl p-6 lg:p-8 shadow-lg hover:shadow-2xl transition-all duration-300 border border-gray-200/50 dark:border-gray-700/50 hover:border-primary-300 dark:hover:border-primary-600 hover:-translate-y-2"
        [class.ring-2]="review.isPinned"
        [class.ring-primary-500]="review.isPinned">
        
        <!-- Pinned Badge -->
        @if (review.isPinned) {
        <div class="absolute top-4 ltr:right-4 rtl:left-4">
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-primary-500 text-white">
            <i class="pi pi-thumbtack me-1"></i>
            {{ 'reviews.featured' | translate }}
          </span>
        </div>
        }

        <!-- Customer Info -->
        <div class="flex items-center gap-4 mb-4">
          <div
            class="w-12 h-12 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white font-bold text-lg">
            {{ review.customerName.charAt(0).toUpperCase() }}
          </div>
          <div>
            <h3 class="font-semibold text-gray-900 dark:text-white text-lg">
              {{ review.customerName }}
            </h3>
            <!-- Rating Stars -->
            <div class="flex items-center gap-1 mt-1">
              @for (star of getStarsArray(review.rating); track $index) {
              <i [class]="star ? 'pi pi-star-fill text-yellow-400' : 'pi pi-star text-gray-300'"></i>
              }
            </div>
          </div>
        </div>

        <!-- Comment -->
        @if (review.comment) {
        <p class="text-gray-600 dark:text-gray-300 mb-4 line-clamp-4 transition-colors duration-300">
          {{ review.comment }}
        </p>
        }

        <!-- Images Gallery -->
        @if (review.images && review.images.length > 0) {
        <div class="grid grid-cols-3 gap-2 mb-4">
          @for (image of review.images.slice(0, 3); track image.id) {
          <div class="relative aspect-square rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-700">
            <img [src]="getImageUrl(image.filePath)" [alt]="image.originalFileName || ('reviews.review_image' | translate)"
              class="w-full h-full object-cover hover:scale-110 transition-transform duration-300" fallback>
          </div>
          }
          @if (review.images.length > 3) {
          <div
            class="relative aspect-square rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-700 flex items-center justify-center">
            <span class="text-sm font-semibold text-gray-600 dark:text-gray-300">
              +{{ review.images.length - 3 }}
            </span>
          </div>
          }
        </div>
        }

        <!-- Video -->
        @if (review.video || review.videoUrl) {
        <div class="mb-4 rounded-lg overflow-hidden">
          @if (review.video) {
          <video [src]="getImageUrl(review.video.filePath)" controls
            class="w-full h-48 object-cover rounded-lg" muted>
            {{ 'reviews.video_not_supported' | translate }}
          </video>
          } @else if (review.videoUrl) {
          <div class="relative aspect-video bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden">
            <iframe [src]="review.videoUrl | safe:'resourceUrl'" frameborder="0" allowfullscreen
              class="absolute inset-0 w-full h-full"></iframe>
          </div>
          }
        </div>
        }

        <!-- Date -->
        @if (review.createdAt) {
        <div class="text-xs text-gray-400 dark:text-gray-500 mt-4">
          <i class="pi pi-calendar me-1"></i>
          {{ review.createdAt | date:'mediumDate' }}
        </div>
        }
      </div>
      }
    </div>
  </div>
</section>
}

